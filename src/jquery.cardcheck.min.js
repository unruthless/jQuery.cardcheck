/*!
 * jQuery.cardcheck
 * A plugin for detecting and validating credit cards
 *
 * https://github.com/unruthless/jQuery.cardcheck
 *
 * Copyright (c) 2010 Ruthie BenDor and Tim Branyen
 * Dual licensed under the MIT and GPL licenses.
 *
 */
(function(j,k,d){var e;d.cardcheck=function(a){var c=e.types||[],h=typeof a==="string"?a:a.num,a=h.length,b,i=!1,f=!1;d.each(c,function(a,c){if(c.checkType(h))return b=a,!1});h&&c&&c[b]&&(i=c[b].checkLength(a),f=e.checkLuhn(h));return{type:b,validLen:i,validLuhn:f}};d.fn.cardcheck=function(a){if(a&&d.isFunction(a)){var c=d({},e);c.callback=a;a=c}else a=d.extend({},e,a);return this.bind("keyup",function(){var c=a.types||{},b=this.value.replace(/\D+/g,""),e="",f="",g=d.cardcheck({num:b});if(typeof g.type===
"number")e=c[g.type].name,f=c[g.type].className;a.callback.call(this,{num:b,len:b.length,cardName:e,cardClass:f,validLen:g.validLen,validLuhn:g.validLuhn,opts:a})})};e=d.fn.cardcheck.opts={checkLuhn:function(a){var c=a.length;if(!a||!c)return!1;var a=a.split("").reverse(),d=0,b;for(b=0;b<c;b++)a[b]=j.parseInt(a[b],10),d+=b%2?2*a[b]-(a[b]>4?9:0):a[b];return d%10===0},types:[{name:"Visa",className:"visa",checkType:function(a){return a.charAt(0)==="4"},checkLength:function(a){return a===13||a===16}},
{name:"American Express",className:"amex",checkType:function(a){return a.substr(0,2)==="34"||a.substr(0,2)==="37"},checkLength:function(a){return a===15}},{name:"MasterCard",className:"mastercard",checkType:function(a){if(a.charAt(0)==="5")return a.charAt(1)>=1&&a.charAt(1)<=5;return!1},checkLength:function(a){return a===16}},{name:"Discover",className:"discover",checkType:function(a){if(a.charAt(0)==="6")return a.substr(0,2)==="65"||a.substr(0,4)==="6011"||a.substr(0,3)==="644";return!1},checkLength:function(a){return a===
16}},{name:"JCB",className:"jcb",checkType:function(a){return a.substr(0,2)==="35"},checkLength:function(a){return a===16}},{name:"Diners Club",className:"diners",checkType:function(a){return a.substr(0,2)==="36"||a.substr(0,2)==="38"},checkLength:function(a){return a===14}}],callback:d.noop}})(this,this.document,this.jQuery);